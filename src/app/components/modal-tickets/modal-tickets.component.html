<div *ngIf="ticket" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" tabindex="-1" role="dialog" aria-labelledby="modalTicket" aria-hidden="true">
    <div class="bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-90vh overflow-hidden mx-4" role="document">
      <div class="bg-gray-50 px-6 py-4 border-b border-gray-200">
        <div class="flex justify-between items-center">
          <h2 class="text-xl font-semibold text-gray-900" id="modalInfoLabel">
            Ticket # {{ticket.contador}} para 
            <a href="" 
              (click)="openCustomerModal(ticket.cliente); $event.preventDefault()" 
              class="text-orange-600 hover:text-orange-700 underline">{{ticket.cliente.nombre}} {{ticket.cliente.apellidos}}
            </a>
          </h2>
          <button type="button" class="text-gray-400 hover:text-gray-600 p-2 rounded-lg hover:bg-gray-100 transition-colors duration-200" aria-label="Close" (click)="closeTicket()">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
      </div>
      <div class="p-6 overflow-y-auto max-h-96">
        <div class="flex items-center justify-around pt-3 mb-6">
          <div *ngFor="let estado of estados" class="flex flex-col items-center justify-center" [ngClass]="{'text-gray-400': ticket.estado.posicion > estado.posicion}">
            <div class="pb-2 text-sm font-medium">{{estado.nombre}}</div>
            <div class="w-4 h-4 rounded-full border-2" [ngClass]="{'bg-orange-500 border-orange-500': ticket.estado.posicion === estado.posicion, 'bg-green-500 border-green-500': ticket.estado.posicion > estado.posicion, 'border-gray-300': ticket.estado.posicion < estado.posicion}"></div>
          </div>
        </div>
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden pt-3" id="containerServicesTable">
          <table id="tablaServices" class="w-full">
            <thead class="bg-gray-50">
              <tr>
                <th class="px-4 py-3 text-left text-sm font-medium text-gray-900">Unidades</th>
                <th class="px-4 py-3 text-left text-sm font-medium text-gray-900">Productos</th>
                <th class="px-4 py-3 text-left text-sm font-medium text-gray-900">Servicio</th>
                <th class="px-4 py-3 text-center text-sm font-medium text-gray-900">Acabado</th>
              </tr>
            </thead>
            <tbody id="customersBodyTable" class="divide-y divide-gray-200">
                <tr *ngFor="let servicio of ticket.servicios" class="customer">
                    <td class="align-content-center" #unidades>{{servicio.unidades}}</td>
                    <td class="align-content-center" #producto>{{servicio.producto?.nombre || ''}}</td>
                    <td class="align-content-center" #servicio>{{servicio.servicio.nombre}}</td>
                    <td class="align-content-center text-center" #finalizado>
                      <input type="checkbox" name="finalizado" id="" [checked]="servicio.finalizado">
                    </td>
                </tr>
            </tbody>
            </table>
          </div>
          <div class="row pt-3 d-flex flex-column align-items-center justify-content-center">
            <div class="col-12">
              <div class="row m-0">
                <div class="col-12">
                  <h2>Comentarios</h2>
                </div>
                <div class="col-12 d-flex flex-column align-items-center justify-content-between rounded-3 p-3">
                  <div class="comentario row w-100" *ngFor="let comentario of ticket.comentarios">
                    <div class="col-4 p-0">
                      <p class="m-0 shadow-sm">{{comentario}}</p>
                    </div>
                  </div>
                </div>
                <div class="col-12">
                  <div class="pt-3 row m-0 d-flex align-items-center justify-content-end">
                    <textarea name="" id="" class="col-12 rounded p-1"></textarea>
                    <div class="col-2 pt-3 pe-0 d-flex align-items-center justify-content-end">
                      <button id="enviar-comentario" class="btn btn-success w-100">Enviar</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" (click)="closeTicket()">Cerrar</button>
        </div>
      </div>
    </div>
  <app-modal-customer
    *ngIf="showCustomerModal"
    [customer]="selectedCustomer"
    (close)="closeCustomerModal()">
  </app-modal-customer>